<input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}" />
<script type="application/json" data-type="product-variations-data">
[{%- for variant in product.variants -%}
{%- if variant.featured_image -%}
{%- assign featured_image = variant.featured_image -%}
{%- else -%}
{%- assign featured_image = product.featured_image -%}
    {% endif -%}
{"id":"{{variant.id}}", "available": {{variant.available}}, "sku": "{{variant.sku}}", "barcode": "{{variant.barcode}}","price": "{{variant.price | money }}","option1": "{{ variant.option1 | handle }}", "option2": "{{ variant.option2 | handle }}", "option3": "{{ variant.option3 | handle }}", "featured_image": "{{featured_image | img_url: "master" }}", "more_images": {{ variant.metafields.udesly.more-images | json }} }{% unless forloop.last %},{% endunless %}
    {%- endfor -%}]
</script>